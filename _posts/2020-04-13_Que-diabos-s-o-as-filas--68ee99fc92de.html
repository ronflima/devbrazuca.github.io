<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Que diabos são as filas?</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Que diabos são as filas?</h1>
</header>
<section data-field="subtitle" class="p-summary">
Saiba um pouco sobre esta importante estrutura de dados
</section>
<section data-field="body" class="e-content">
<section name="286d" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="42c4" id="42c4" class="graf graf--h3 graf--leading graf--title">Que diabos são as filas?</h3><h4 name="c1e5" id="c1e5" class="graf graf--h4 graf-after--h3 graf--subtitle">Saiba um pouco sobre esta importante estrutura de dados</h4><figure name="0ae8" id="0ae8" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*_bVU40MJgXduM_LOvaoy7g.jpeg" data-width="1920" data-height="1280" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*_bVU40MJgXduM_LOvaoy7g.jpeg"><figcaption class="imageCaption">Photo by <a href="https://www.pexels.com/@freestocks?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" data-href="https://www.pexels.com/@freestocks?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">freestocks.org</a> from <a href="https://www.pexels.com/photo/person-in-black-sweater-hold-a-grey-road-bike-122477/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" data-href="https://www.pexels.com/photo/person-in-black-sweater-hold-a-grey-road-bike-122477/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Pexels</a></figcaption></figure><p name="b8b3" id="b8b3" class="graf graf--p graf-after--figure">Voltando a falar um pouco sobre estruturas de dados, agora é a hora de falar sobre as filas. Esta é uma estrutura de dados fantástica, principalmente quando usada em ambientes multi-processados. É tão importante que o seu sistema operacional certamente implementa algum tipo de fila que o seu software pode tirar proveito para realizar processamento pesado.</p><p name="e5f6" id="e5f6" class="graf graf--p graf-after--p">Por exemplo, o Windows é amplamente baseado em filas. Tudo o que acontece no sistema é enfileirado em uma fila de mensagens. Existem as filas globais e as filas locais. Nas primeiras versões, as filas eram todas globais o que fazia com que o sistema caísse se uma janela travasse. O Windows NT foi o primeiro a implementar filas locais para as janelas, o que impedia que o travamento de uma janela levasse o sistema consigo. Esta tecnologia foi, depois, utilizada no Windows 95 e posteriores.</p><p name="91b6" id="91b6" class="graf graf--p graf-after--p">No Unix a conversa sempre foi diferente pois o sistema de janelas sempre foi um processo de usuário e nunca um processo de sistema. Mesmo o servidor XWindows, nunca operou diretamente no kernel, fazendo chamadas de sistema como qualquer outro processo. E isso conferiu ao Unix a sua lendária estabilidade, herdada pelo Linux que seguiu a mesma filosofia.</p><p name="db4c" id="db4c" class="graf graf--p graf-after--p">Mas, enfim, chega de história da Carochinha. Vamos ao que viemos.</p><h4 name="2e9f" id="2e9f" class="graf graf--h4 graf-after--p">Por que filas?</h4><p name="c832" id="c832" class="graf graf--p graf-after--h4">O cenário clássico de utilização de filas tem a ver com a comunicação entre duas partes. Imagine duas entidades, A e B, comunicando-se através de um meio qualquer. A envia mensagens para B e B precisa realizar algo com essas mensagens. No entanto, A envia mensagens mais rápido do que B pode realizar algo com elas.</p><p name="cab4" id="cab4" class="graf graf--p graf-after--p">Neste cenário, B perderá algumas mensagens por que estará ocupado realizando algo enquanto A envia-lhe mais mensagens. Este é um cenário comum na comunicação de dados, ou seja, um lado consegue enviar mensagens mais rápido do que o outro consegue receber. E é aqui que as filas resolvem o problema: ao invés de perder as mensagens, B as coloca em uma fila.</p><p name="e3f1" id="e3f1" class="graf graf--p graf-after--p">Claro, as filas são mais úteis do que apenas sincronizar mensagens entre dois processos. Por exemplo, o <em class="markup--em markup--p-em">pipeline</em> é um método de paralelismo de processamento que vem sendo usado desde o processador 8088. Trata-se, basicamente, de uma fila.</p><h4 name="1d9a" id="1d9a" class="graf graf--h4 graf-after--p">Desacoplando componentes com filas</h4><p name="c36d" id="c36d" class="graf graf--p graf-after--h4">Basicamente todo software é composto por um ou mais workflows. Estes workflows são implementados por um ou mais componentes. Ao usar filas você cria um canal de comunicação entre cada componente do seu software, desacoplando-os uns dos outros. Os componentes passam a depender da fila e não dos outros componentes. Se há algo na fila, o componente retira a mensagem e faz algo. Se não há nada, volta a dormir. Simples assim.</p><p name="f7e5" id="f7e5" class="graf graf--p graf-after--p">Claro, há mecanismos mais inteligentes de notificação do que simplesmente fazer <em class="markup--em markup--p-em">polling</em> na lista. Por exemplo, sinais podem ser usados, ou até mesmo semáforos e mutexes. Sem softwares remotos, pode-se criar um mecanismo de notificação via request HTTP, uma mensagem via multicast… São inúmeras as soluções possíveis.</p><p name="e194" id="e194" class="graf graf--p graf-after--p">As filas são particularmente poderosas quando combinadas com threads. O <em class="markup--em markup--p-em">pattern</em> <em class="markup--em markup--p-em">master/worker</em> é fortemente baseado em filas: o <em class="markup--em markup--p-em">master</em> carrega uma fila com solicitações de processamento que são realizadas pelos <em class="markup--em markup--p-em">workers</em>. Sempre que coloca algo na fila, o <em class="markup--em markup--p-em">master</em> realiza um broadcast via mutex para que os <em class="markup--em markup--p-em">workers</em> sejam destravados e entrem em execução imediatamente para consumir a fila. Vários softwares de servidor funcionam com base neste princípio.</p><h4 name="b9a7" id="b9a7" class="graf graf--h4 graf-after--p">As filas podem ser distribuídas</h4><p name="5083" id="5083" class="graf graf--p graf-after--h4">Existem vários softwares que implementam filas nos dias de hoje. ZeroMQ, RabbitMQ e MQSeries são exemplos. Estas filas podem ser distribuídas, ou seja, permitirem que computadores distintos tenham acesso a elas, depositando ou consumindo mensagens. E a principal vantagem é o desacoplamento entre as partes: se o emissor cair, por algum motivo, o consumidor pode continuar a processar e vice-versa.</p><p name="e988" id="e988" class="graf graf--p graf-after--p">As filas aumentam a resiliência de um sistema, permitindo-o suportar falhas sem, necessariamente, jogar todo o sistema no chão. Com a distribuição de filas, o seu sistema pode ser projetado para ter vários componentes em execução distribuídos por vários data centers. Isso permite que o seu sistema tire proveito to multi-processamento e da possibilidade de escalamento de carga.</p><h4 name="bacc" id="bacc" class="graf graf--h4 graf-after--p">As filas do sistema operacional</h4><p name="0a16" id="0a16" class="graf graf--p graf-after--h4">Sim, o seu sistema operacional tem uma implementação de filas. Se você usa o Linux ou algum Unix, incluindo-se o macOS, você pode fazer uso das filas para distribuir o processamento dentro do seu próprio sistema. Ah, o Windows vem com o MsMQ, uma implementação de <em class="markup--em markup--p-em">message queues</em> que você também pode tirar proveito.</p><p name="42fb" id="42fb" class="graf graf--p graf-after--p">Mas, por que usar filas dentro da mesma máquina? Pelo mesmo motivo: você pode orquestrar o processamento por vários processos, compartilhando e organizando as informações processadas através de filas de mensagens. As mensagens dentro das filas permanecem disponíveis mesmo que os processos que as consomem caiam por algum motivo. Afinal, as filas são entidades do sistema operacional, mesmo que o seu processo as tenha criado.</p><p name="e6dc" id="e6dc" class="graf graf--p graf-after--p">O problema de usar vários processos é que a complexidade do seu sistema tende a aumentar: passa a ser necessário orquestrar diversos processos rodando em paralelo. No entanto, o seu sistema passa a ser mais resiliente: uma falha em um componente não causa a queda do sistema como um todo, mas de apenas parte do sistema.</p><h4 name="8a53" id="8a53" class="graf graf--h4 graf-after--p">Quer saber mais?</h4><p name="0bb2" id="0bb2" class="graf graf--p graf-after--h4">Se você quiser implementar seu próprio algoritmo de filas, bom, é bem simples. Existem diversos livros sobre o assunto pois trata-se de um algoritmo muito comum. As linguagens modernas, em particular as que implementam por padrão algum tipo de coleção de dados, tem boas implementações de filas. Vale dizer que mesmo que a sua linguagem não suporte diretamente as filas, implementar é muito fácil.</p><p name="dc71" id="dc71" class="graf graf--p graf-after--p">Sobre as filas do sistema operacional, estas fazem parte do IPC (do inglês <em class="markup--em markup--p-em">Inter-process Communication</em>), o esquema de comunicação inter-processos do seu sistema operacional. Trata-se de algo muito antigo e muito bem documentado, também sendo absolutamente estável.</p><p name="6fb9" id="6fb9" class="graf graf--p graf-after--p">Com relação às filas distribuídas, você encontra muito material na internet, principalmente no seu provedor de serviços de infra-estrutura. Serviços como AWS e Azure oferecem filas distribuídas como parte da sua carteira de serviços. E todos muito bem documentados.</p><p name="379f" id="379f" class="graf graf--p graf-after--p graf--trailing">Bom, é isso aí. Happy Coding!</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@ronaldolima" class="p-author h-card">Ronaldo Faria Lima</a> on <a href="https://medium.com/p/68ee99fc92de"><time class="dt-published" datetime="2020-04-13T10:53:20.681Z">April 13, 2020</time></a>.</p><p><a href="https://medium.com/@ronaldolima/que-diabos-s%C3%A3o-as-filas-68ee99fc92de" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 25, 2020.</p></footer></article></body></html>